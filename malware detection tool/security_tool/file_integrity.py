import hashlib
import os

def hash_file(filepath):
    with open(filepath, 'rb') as f:
        file_hash = hashlib.sha256()
        while chunk := f.read(8192):
            file_hash.update(chunk)
    return file_hash.hexdigest()

def monitor_file_integrity():
    critical_files = ["C:\\Windows\\System32\\config\\system"]  # Example path
    baseline = {file: hash_file(file) for file in critical_files}
    current_state = {file: hash_file(file) for file in critical_files}

    altered_files = [file for file in critical_files if baseline[file] != current_state[file]]
    return altered_files or ["No unauthorized changes detected."]

